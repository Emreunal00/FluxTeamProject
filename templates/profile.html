<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profil Sayfası</title>
    <link rel="stylesheet" href="../frontend/styles_profile.css">
</head>
<body>

    <div class="navbar">
        <div>
            <a href="/dashboard" class="flux-btn">FLUX</a>
        </div>
        <div>
            <a href="/logout" class="logout-btn">Çıkış Yap</a>
        </div>
    </div>

    <div class="profile-container">
        <h2>Profil Bilgileriniz</h2>
        <div class="profile-info">
            <img src="default-profile.jpg" alt="Profil Resmi" id="profile-image">
            <div>
                <p><strong>Kullanıcı Adı:</strong> {{ user_username }}</p>
                <p><strong>E-posta:</strong> {{ user_email }}</p>
            </div>
        </div>

        <button class="update-btn" id="update-profile-btn">Profil Resmini Güncelle</button>

        <div id="image-upload-container" style="display: none;">
            <form id="image-upload-form" enctype="multipart/form-data">
                <input type="file" name="profileImage" accept="image/*" id="profile-image-input">
                <button type="submit" class="btn-success">Yükle</button>
            </form>
        </div>
    </div>

    <!-- JavaScript kodları burada -->
    <script>
        window.onload = function() {
            fetch('/get-user-profile')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('profile-image').src = data.profile_image || 'default-profile.jpg';
                })
                .catch(error => console.error('Error fetching profile data:', error));
        };

        const updateProfileBtn = document.getElementById("update-profile-btn");
        const profileImageInput = document.getElementById("profile-image-input");

        updateProfileBtn.addEventListener("click", function() {
            profileImageInput.click();
        });

        profileImageInput.addEventListener("change", function() {
            const file = profileImageInput.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onloadend = function() {
                    document.getElementById("profile-image").src = reader.result;
                };
                reader.readAsDataURL(file);
            }
        });
    </script>
</body>
</html>
